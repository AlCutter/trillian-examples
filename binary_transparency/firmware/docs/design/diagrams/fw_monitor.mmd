sequenceDiagram
    participant vendor as Firmware Vendor
    participant log as Log Operator
    participant monitor as Monitor
    participant alert as Alert

    activate log
    activate monitor

    loop Forever

        monitor ->>+ log: GetLatestLogRoot
        log -->>- monitor: LatestLogRoot
        monitor ->>+ log: GetConsistencyProof
        log -->>- monitor: ConsistencyProof
        log ->> log: Validate ConsistencyProof

        rect rgba(0, 0, 0, 0.1)
        loop For each new LogEntry e
            monitor ->>+ log: GetEntry e
            log -->>- monitor: Entry e

            rect rgba(1, 0, 0, 0.1)
                opt Badness detected
                    monitor --X alert: Alert
                end
            end
            rect rgba(0, 0, 0, 0.1)
                opt Firmware from Vendor detected
                    monitor --X vendor: Inform
                end
            end
        end
        end
    end

    deactivate monitor
    deactivate log